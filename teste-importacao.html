<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Importa√ß√£o de Produtos</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="admin/css/admin-styles.css">
    
    <!-- JavaScript Dependencies -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <style>
        body { 
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; 
            margin: 20px; 
            background: #f1f1f1; 
        }
        .wrap { 
            background: white; 
            padding: 20px; 
            border-radius: 5px; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.13);
        }
    </style>
</head>
<body>
    <div class="wrap">
        <h1>üöÄ Teste - Importa√ß√£o de Produtos</h1>
        
        <!-- Simula√ß√£o da p√°gina de importa√ß√£o -->
        <div class="card">
            <h3>üîó Conex√£o com Lojista</h3>
            <p>Simular lojista conectado para teste</p>
            <button id="btn-carregar-produtos" class="button button-primary">üìã Carregar Produtos</button>
        </div>
        
        <!-- Se√ß√£o de produtos (inicialmente oculta) -->
        <div id="produtos-section" style="display: none;">
            <div class="card">
                <h3>Produtos Dispon√≠veis</h3>
                
                <!-- Controles -->
                <div class="controles-section">
                    <div class="controles-row">
                        <label>
                            <input type="checkbox" id="selecionar-todos"> 
                            Selecionar Todos
                        </label>
                        <input type="text" id="buscar-produto" placeholder="üîç Buscar por nome ou SKU..." class="regular-text">
                        <span id="produtos-count" class="contador-produtos">0 produtos selecionados</span>
                    </div>
                </div>
                
                <!-- Grid de Produtos -->
                <div id="produtos-resumo"></div>
                <div id="produtos-grid"></div>
            </div>
        </div>
        
        <!-- Op√ß√µes de importa√ß√£o (inicialmente oculta) -->
        <div id="opcoes-importacao" style="display: none;">
            <div class="card">
                <h3>‚öôÔ∏è Op√ß√µes de Importa√ß√£o</h3>
                <button id="btn-importar-produtos" class="button button-primary" disabled>üöÄ Importar Produtos Selecionados</button>
            </div>
        </div>
        
        <div id="debug-log" style="margin-top: 20px; padding: 10px; background: #f9f9f9; border-radius: 5px;">
            <h4>üìã Debug Log:</h4>
            <div id="log-content"></div>
        </div>
    </div>

    <script>
        // Configura√ß√£o AJAX mock para teste
        const WC = {
            ajaxurl: 'test-ajax.php',
            nonce: 'test-nonce-123'
        };
        
        // Mock do SincronizadorModals
        const SincronizadorModals = {
            setButtonLoading: function(btn, loading, text) {
                if (loading) {
                    btn.prop('disabled', true).text('‚è≥ Carregando...');
                } else {
                    btn.prop('disabled', false).text(text || 'üìã Carregar Produtos');
                }
            },
            showToast: function(message, type) {
                this.log('Toast: ' + message);
            },
            mostrarErro: function(message) {
                this.log('ERRO: ' + message);
                alert('Erro: ' + message);
            },
            log: function(message) {
                $('#log-content').append('<div>' + new Date().toLocaleTimeString() + ' - ' + message + '</div>');
            }
        };
        
        // Mock de produtos de teste
        const mockProdutos = [
            {
                id: 1,
                nome: "Produto Teste 1",
                sku: "SKU001",
                preco: 99.90,
                preco_promocional: 79.90,
                em_promocao: true,
                estoque: 10,
                categoria: "Categoria A",
                imagem: "https://via.placeholder.com/150x150/007cba/ffffff?text=Produto+1",
                status: "ativo",
                descricao: "Descri√ß√£o do produto 1",
                descricao_curta: "Descri√ß√£o curta 1"
            },
            {
                id: 2,
                nome: "Produto Teste 2",
                sku: "SKU002",
                preco: 149.90,
                preco_promocional: 0,
                em_promocao: false,
                estoque: 0,
                categoria: "Categoria B",
                imagem: "https://via.placeholder.com/150x150/28a745/ffffff?text=Produto+2",
                status: "ativo",
                descricao: "Descri√ß√£o do produto 2",
                descricao_curta: "Descri√ß√£o curta 2"
            },
            {
                id: 3,
                nome: "Produto Teste 3",
                sku: "SKU003",
                preco: 199.90,
                preco_promocional: 159.90,
                em_promocao: true,
                estoque: 5,
                categoria: "Categoria C",
                imagem: "https://via.placeholder.com/150x150/dc3545/ffffff?text=Produto+3",
                status: "ativo",
                descricao: "Descri√ß√£o do produto 3",
                descricao_curta: "Descri√ß√£o curta 3"
            }
        ];
        
        // Mock da chamada AJAX
        function mockAjax() {
            return {
                done: function(callback) {
                    setTimeout(() => {
                        callback({
                            success: true,
                            data: mockProdutos
                        });
                    }, 1000);
                    return this;
                },
                fail: function(callback) {
                    return this;
                },
                always: function(callback) {
                    setTimeout(callback, 1100);
                    return this;
                }
            };
        }
        
        // Override do $.post para teste
        $.post = function(url, data) {
            SincronizadorModals.log('AJAX Call: ' + data.action);
            return mockAjax();
        };
    </script>
    
    <!-- Incluir o JavaScript do admin -->
    <script src="admin/js/admin-scripts.js"></script>
    
    <script>
        // Inicializa√ß√£o para teste
        $(document).ready(function() {
            SincronizadorModals.log('P√°gina de teste carregada');
            SincronizadorModals.log('Clique no bot√£o "Carregar Produtos" para testar');
        });
    </script>
</body>
</html>
